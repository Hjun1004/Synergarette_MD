<!DOCTYPE html>
<html>

<!-- 모바일에서 화면 압축 금지 -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
    <meta charset="utf-8">
    <title>송금 안내</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 2em; }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            margin: 10px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h2>안녕하세요. 시너가렛입니다.</h2>
    <h2>소중한 팬분들의 시간을 아껴드리기 위해</h2>
    <h2>계좌번호를 복사하시고</h2>
    <h2>송금하실 은행을 선택해주시면 감사하겠습니다.</h2>

    <!-- <a href="shinhan-sbank://" class="btn">신한은행으로 송금하기</a><br> -->
    <button class="btn" id="open-sol-btn">신한 SOL 실행하기</button><br>
    <a class="btn" href="#" onclick="appLink(); return false;" >국민은행으로 송금하기</a><br>
    <!-- <a href="toss://send?accountNo=12345678901234&bankCode=88" class="btn">토스로 송금하기</a> -->
    <button class="btn" id="open-toss-btn">토스 앱 열기 / 송금하기</button><br>
    <button class="btn" id="open-busanbank-btn">부산은행 앱 열기</button>

    <script>
        function appLink() {
            var locIOS     = "kbbank://call?";
            var locAndroid = "intent://call?#Intent;scheme=kbbank;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.kbstar.kbbank;end";
            var userAgent  = navigator.userAgent.toLowerCase();
        
            var delfinoYn = /Delfino-/i;
        
            if (userAgent.match(/iphone/) && !userAgent.match(delfinoYn)) {
                setTimeout(function() {
                    location.href = "https://itunes.apple.com/kr/app/kbseutabaengking/id373742138?mt=8";
                }, 1500);
                location.href = locIOS;
                return;
            } else if (userAgent.match(/android/) && !userAgent.match(delfinoYn)) {
                var androidStoreUrl = "https://play.google.com/store/apps/details?id=com.kbstar.kbbank";
        
                if (userAgent.match(/chrome/)) {
                    location.href = locAndroid;
                } else {
                    setTimeout(function() {
                        location.href = androidStoreUrl;
                    }, 1500);
        
                    var iframe = document.createElement('iframe');
                    iframe.style.visivility = 'hidden';
                    iframe.src = url;
                    documentbody.appendChild(iframe);
                    documentbody.removeChild(iframe);
                }
                return;
            }
        }
    </script>

    <script>
        (function () {
          const ANDROID_PACKAGE = "com.shinhan.sbanking";
          const PLAY = `https://play.google.com/store/apps/details?id=${ANDROID_PACKAGE}`;
          const INTENT = `intent://open#Intent;scheme=shinhansol;package=${ANDROID_PACKAGE};S.browser_fallback_url=${encodeURIComponent(PLAY)};end`;
          const DEEPLINK = "shinhansol://"; // 필요시 "shinhansol://transfer" 로 교체
        
          const isAndroid = /Android/i.test(navigator.userAgent);
          const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        
          function openAndroid({ withFallback = true } = {}) {
            const start = Date.now();
            let hidden = false;
            let fallbackTimer;
        
            const cancelFallback = () => {
              hidden = true;             // 앱으로 전환되면 hidden=true
              if (fallbackTimer) clearTimeout(fallbackTimer);
              removeGuards();
            };
        
            const removeGuards = () => {
              document.removeEventListener("visibilitychange", onVisibility);
              window.removeEventListener("pagehide", cancelFallback);
              window.removeEventListener("blur", cancelFallback);
            };
        
            const onVisibility = () => {
              if (document.visibilityState === "hidden") cancelFallback();
            };
        
            document.addEventListener("visibilitychange", onVisibility);
            window.addEventListener("pagehide", cancelFallback);
            window.addEventListener("blur", cancelFallback);
        
            // 1) Android에선 intent를 먼저 시도 (Chrome 권장)
            location.href = INTENT;
        
            if (!withFallback) {
              // 폴백 비활성: 앱 없으면 그냥 아무 변화 없게
              setTimeout(removeGuards, 2000);
              return;
            }
        
            // 2) 폴백: 여전히 페이지가 보이고(=앱 전환 실패), 시간이 많이 안 지났을 때만 스토어로
            fallbackTimer = setTimeout(() => {
              const elapsed = Date.now() - start;
              const stillVisible = document.visibilityState === "visible";
              if (!hidden && stillVisible && elapsed < 1800) location.href = PLAY;
              removeGuards();
            }, 1200);
          }
        
          function openIOS({ withFallback = true } = {}) {
            const start = Date.now();
            let fallbackTimer;
        
            const cancel = () => {
              if (fallbackTimer) clearTimeout(fallbackTimer);
              document.removeEventListener("visibilitychange", onVisibility);
              window.removeEventListener("pagehide", cancel);
              window.removeEventListener("blur", cancel);
            };
            const onVisibility = () => {
              if (document.visibilityState === "hidden") cancel();
            };
            document.addEventListener("visibilitychange", onVisibility);
            window.addEventListener("pagehide", cancel);
            window.addEventListener("blur", cancel);
        
            // 1) 딥링크
            location.href = DEEPLINK;
        
            if (!withFallback) {
              setTimeout(cancel, 2000);
              return;
            }
        
            // 2) 폴백
            fallbackTimer = setTimeout(() => {
              const elapsed = Date.now() - start;
              const stillVisible = document.visibilityState === "visible";
              if (stillVisible && elapsed < 1800) {
                location.href = "https://apps.apple.com/kr/app/id357484932"; // 신한 SOL뱅크
              }
              cancel();
            }, 1500);
          }
        
          document.getElementById("open-sol-btn").addEventListener("click", () => {
            if (isAndroid) return openAndroid({ withFallback: true });
            if (isIOS) return openIOS({ withFallback: true });
            alert("모바일 기기에서 열어주세요.");
          });
        })();
    </script>

    <script>
        (function () {
          const DEEPLINK = "supertoss://";  // 토스 앱 스킴
          const ANDROID_PLAY = "https://play.google.com/store/apps/details?id=viva.republica.toss";
          const IOS_STORE    = "https://apps.apple.com/kr/app/id839333328";
        
          const isAndroid = /Android/i.test(navigator.userAgent);
          const isIOS     = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        
          // Android: 앱만 시도 (폴백 X)
          function openAndroid({ withFallback = true } = {}) {
            const start = Date.now();
            let fallbackTimer;
        
            const cancel = () => {
              if (fallbackTimer) clearTimeout(fallbackTimer);
              document.removeEventListener("visibilitychange", onVis);
              window.removeEventListener("pagehide", cancel);
              window.removeEventListener("blur", cancel);
            };
        
            const onVis = () => {
              // 앱으로 전환되면 hidden → 폴백 취소
              if (document.visibilityState === "hidden") cancel();
            };
        
            document.addEventListener("visibilitychange", onVis);
            window.addEventListener("pagehide", cancel);
            window.addEventListener("blur", cancel);
        
            // 1) 토스 앱 스킴 호출
            window.location.href = DEEPLINK;
        
            if (!withFallback) {
              // 폴백 안 쓸 거면 일정 시간 뒤에 가드만 제거
              setTimeout(cancel, 2000);
              return;
            }
        
            // 2) (옵션) 설치 안 되어 있으면 Play 스토어로
            fallbackTimer = setTimeout(() => {
              const stillVisible = document.visibilityState === "visible";
              const elapsed = Date.now() - start;
              if (stillVisible && elapsed < 1800) {
                window.location.href = ANDROID_PLAY;
              }
              cancel();
            }, 1200);
          }
        
          // iOS: 앱만 시도 (폴백 X)
          function openIOS({ withFallback = true  } = {}) {
            const start = Date.now();
            let fallbackTimer;
        
            const cancel = () => {
              if (fallbackTimer) clearTimeout(fallbackTimer);
              document.removeEventListener("visibilitychange", onVis);
              window.removeEventListener("pagehide", cancel);
              window.removeEventListener("blur", cancel);
            };
        
            const onVis = () => {
              if (document.visibilityState === "hidden") cancel();
            };
        
            document.addEventListener("visibilitychange", onVis);
            window.addEventListener("pagehide", cancel);
            window.addEventListener("blur", cancel);
        
            window.location.href = DEEPLINK;
        
            if (!withFallback) {
              setTimeout(cancel, 2000);
              return;
            }
        
            // (옵션) App Store 폴백
            fallbackTimer = setTimeout(() => {
              const stillVisible = document.visibilityState === "visible";
              const elapsed = Date.now() - start;
              if (stillVisible && elapsed < 1800) {
                window.location.href = IOS_STORE;
              }
              cancel();
            }, 1500);
          }
        
          document.getElementById("open-toss-btn").addEventListener("click", () => {
            if (isAndroid) {
              // 그냥 앱만 켜고, 설치 안 되어 있으면 아무 일도 안 일어나게
              return openAndroid({ withFallback: false });
            }
            if (isIOS) {
              return openIOS({ withFallback: false });
            }
            alert("모바일 기기에서 열어주세요.");
          });
        })();
    </script>

    <script>
        (function(){
          const ANDROID_PLAY = "https://play.google.com/store/apps/details?id=kr.co.busanbank.mbp";
          const IOS_STORE    = "https://apps.apple.com/kr/app/id1445137607";
        
          const DEEPLINK = "busanbank://";  // 앱 스킴, 동작 안 될 수도 있음
        
          const isAndroid = /Android/i.test(navigator.userAgent);
          const isIOS     = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        
          function openAndroid({ withFallback = true } = {}) {
            const start = Date.now();
            let fallbackTimer;
        
            const cancelFallback = () => {
              if (fallbackTimer) clearTimeout(fallbackTimer);
              document.removeEventListener("visibilitychange", onVis);
            };
            const onVis = () => {
              if (document.visibilityState === "hidden") cancelFallback();
            };
            document.addEventListener("visibilitychange", onVis);
        
            // 앱 스킴 호출
            window.location.href = DEEPLINK;
        
            if (!withFallback) {
              setTimeout(cancelFallback, 2000);
              return;
            }
        
            fallbackTimer = setTimeout(()=>{
              if (document.visibilityState === "visible" && (Date.now() - start) < 1800) {
                window.location.href = ANDROID_PLAY;
              }
              cancelFallback();
            }, 1200);
          }
        
          function openIOS({ withFallback = true } = {}) {
            const start = Date.now();
            let fallbackTimer;
            const cancel = () => {
              if (fallbackTimer) clearTimeout(fallbackTimer);
              document.removeEventListener("visibilitychange", onVis);
            };
            const onVis = () => {
              if (document.visibilityState === "hidden") cancel();
            };
            document.addEventListener("visibilitychange", onVis);
        
            window.location.href = DEEPLINK;
        
            if (!withFallback) {
              setTimeout(cancel, 2000);
              return;
            }
        
            fallbackTimer = setTimeout(()=>{
              if (document.visibilityState === "visible" && (Date.now() - start) < 1800) {
                window.location.href = IOS_STORE;
              }
              cancel();
            }, 1500);
          }
        
          document.getElementById("open-busanbank-btn").addEventListener("click", ()=>{
            if (isAndroid) openAndroid({ withFallback: true });
            else if (isIOS) openIOS({ withFallback: true });
            else alert("모바일 기기에서 열어주세요.");
          });
        })();
    </script>

    
    
    <p style="margin-top: 2em; color: gray;">※ 모바일에서만 작동합니다. 앱이 설치되어 있어야 합니다.</p>
</body>
</html>
