<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>송금 안내</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 2em; }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            margin: 10px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h2>송금하실 은행을 선택하세요</h2>

    <a href="shinhan-sbank://" class="btn">신한은행으로 송금하기</a><br>
    <button id="open-sol-btn">신한 SOL 실행하기</button><br>
    <a href="#" onclick="appLink(); return false;"  class="btn">국민은행으로 송금하기</a><br>
    <a href="toss://send?accountNo=12345678901234&bankCode=88" class="btn">토스로 송금하기</a>

    <script>
        function appLink() {
            var locIOS     = "kbbank://call?";
            var locAndroid = "intent://call?#Intent;scheme=kbbank;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.kbstar.kbbank;end";
            var userAgent  = navigator.userAgent.toLowerCase();
        
            var delfinoYn = /Delfino-/i;
        
            if (userAgent.match(/iphone/) && !userAgent.match(delfinoYn)) {
                setTimeout(function() {
                    location.href = "https://itunes.apple.com/kr/app/kbseutabaengking/id373742138?mt=8";
                }, 1500);
                location.href = locIOS;
                return;
            } else if (userAgent.match(/android/) && !userAgent.match(delfinoYn)) {
                var androidStoreUrl = "https://play.google.com/store/apps/details?id=com.kbstar.kbbank";
        
                if (userAgent.match(/chrome/)) {
                    location.href = locAndroid;
                } else {
                    setTimeout(function() {
                        location.href = androidStoreUrl;
                    }, 1500);
        
                    var iframe = document.createElement('iframe');
                    iframe.style.visivility = 'hidden';
                    iframe.src = url;
                    documentbody.appendChild(iframe);
                    documentbody.removeChild(iframe);
                }
                return;
            }
        }
    </script>

    <script>
      (function () {
        const ANDROID_PACKAGE = "com.shinhan.sbanking";
        const ANDROID_PLAY = `https://play.google.com/store/apps/details?id=${ANDROID_PACKAGE}`;
    
        // TODO: iOS App Store ID를 실제 값으로 교체하세요 (예: 1234567890)
        const IOS_APP_ID = "IOS_APP_ID_HERE";
        const IOS_STORE = `https://apps.apple.com/kr/app/id${IOS_APP_ID}`;
    
        // 필요 시 'shinhansol://transfer' 로 바꿔 송금화면 진입 시도(비공식, 일부 버전만)
        const DEEPLINK = "shinhansol://";
    
        const isAndroid = /Android/i.test(navigator.userAgent);
        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        const isMobile = isAndroid || isIOS;
    
        function openOnAndroid() {
          // Chrome/Android에서 권장: intent:// 스킴
          const fallbackUrl = encodeURIComponent(ANDROID_PLAY);
          const intentUrl = `intent://open#Intent;scheme=shinhansol;package=${ANDROID_PACKAGE};S.browser_fallback_url=${fallbackUrl};end`;
    
          // 일부 브라우저는 intent 스킴 미지원 → 직접 딥링크 시도 후 실패 시 플레이스토어
          let opened = false;
    
          const timer = setTimeout(() => {
            if (!opened) {
              // intent 시도 (가장 먼저)
              try {
                window.location.href = intentUrl;
                opened = true;
                return;
              } catch (e) {}
    
              // 딥링크 시도 실패 시 Play 스토어
              window.location.href = ANDROID_PLAY;
            }
          }, 1200);
    
          // 우선 딥링크 직접 시도 (성공하면 타이머 전에 브라우저 전환)
          try {
            window.location.href = DEEPLINK; // ex) shinhansol:// or shinhansol://transfer
          } catch (e) {
            clearTimeout(timer);
            window.location.href = ANDROID_PLAY;
          }
        }
    
        function openOniOS() {
          // iOS는 사용자 제스처(클릭) 안에서 location 변경해야 비교적 안정적
          // 앱 미설치 시 약간의 지연 후 App Store로 유도
          const now = Date.now();
    
          // 1) 딥링크 시도
          window.location.href = DEEPLINK;
    
          // 2) 일정 시간 뒤에도 페이지가 살아있다면(=앱 미설치/실패) App Store로 이동
          setTimeout(() => {
            const elapsed = Date.now() - now;
            // 사용환경/브라우저별로 1500~2000ms 사이가 무난
            if (elapsed < 1800) {
              window.location.href = IOS_STORE;
            }
          }, 1500);
        }
    
        function openShinhanSOL() {
          if (!isMobile) {
            alert("모바일 기기에서 열어주세요. (Android 또는 iOS)");
            return;
          }
          if (isAndroid) return openOnAndroid();
          if (isIOS) return openOniOS();
          // 혹시 모를 기타 모바일
          window.location.href = DEEPLINK;
        }
    
        document.getElementById("open-sol-btn").addEventListener("click", openShinhanSOL);
      })();
    </script>
    <p style="margin-top: 2em; color: gray;">※ 모바일에서만 작동합니다. 앱이 설치되어 있어야 합니다.</p>
</body>
</html>
